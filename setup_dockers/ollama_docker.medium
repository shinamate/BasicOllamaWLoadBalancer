#!/bin/bash
PORT=18330
docker run -it --rm --name ollama_server_medium_01 --hostname ollama_server_medium_01 --gpus all -u 1000:1000 -e "OLLAMA_HOST=172.18.0.4:$PORT" -e "OLLAMA_MODELS=/workspace/model_ollama_medium" -e "OLLAMA_NUM_PARALLEL=3" -e "OLLAMA_MAX_LOADED_MODELS=2" -m 60G --shm-size 60G -v /home/$(id -un)/Documents/ollama_server_mounted:/workspace --net ollama_server_br ollama_server:base bash

tmux new-session -d -s ollama_server_medium
echo "docker start ollama_server_medium_01" > run.sh
chmod u+x ./run.sh
tmux new-window -t ollama_server_medium:1
tmux send-keys -t ollama_server_medium:1 ./run.sh Enter

sleep 5s

echo 'docker exec -it -u 1000:1000 ollama_server_medium_01 bash -ic "ollama serve"' > ./run.sh
chmod u+x ./run.sh
tmux new-window -t ollama_server_medium:2
tmux send-keys -t ollama_server_medium:2 ./run.sh Enter
sleep 5s

echo 'docker exec -it -u 1000:1000 ollama_server_medium_01 bash -ic "ollama run llama3.2-vision:11b --keepalive=24h"' > ./run.sh
chmod u+x ./run.sh
tmux new-window -t ollama_server_medium:3
tmux send-keys -t ollama_server_medium:3 ./run.sh Enter
sleep 10s

#echo 'docker exec -it -u 1000:1000 ollama_server_medium_01 bash -ic "ollama run qwen2.5vl:7b --keepalive=24h"' > ./run.sh
#chmod u+x ./run.sh
#tmux new-window -t ollama_server_medium:4
#tmux send-keys -t ollama_server_medium:4 ./run.sh Enter
#sleep 10s
#
#echo 'docker exec -it -u 1000:1000 ollama_server_medium_01 bash -ic "ollama run qwen3:8b --keepalive=24h"' > ./run.sh
#chmod u+x ./run.sh
#tmux new-window -t ollama_server_medium:5
#tmux send-keys -t ollama_server_medium:5 ./run.sh Enter
#sleep 10s
#
#echo 'docker exec -it -u 1000:1000 ollama_server_medium_01 bash -ic "ollama run ollama_server3:8b --keepalive=24h"' > ./run.sh
#chmod u+x ./run.sh
#tmux new-window -t ollama_server_medium:6
#tmux send-keys -t ollama_server_medium:6 ./run.sh Enter
#sleep 10s
#
#
#echo 'docker exec -it -u 1000:1000 ollama_server_medium_01 bash -ic "ollama run gemma3:4b --keepalive=24h"' > ./run.sh
#chmod u+x ./run.sh
#tmux new-window -t ollama_server_medium:7
#tmux send-keys -t ollama_server_medium:7 ./run.sh Enter
#sleep 10s
#
#echo 'docker exec -it -u 1000:1000 ollama_server_medium_01 bash -ic "ollama run phi4-mini-reasoning:3.8b --keepalive=24h"' > ./run.sh
#chmod u+x ./run.sh
#tmux new-window -t ollama_server_medium:8
#tmux send-keys -t ollama_server_medium:8 ./run.sh Enter
#sleep 10s
#
#echo 'docker exec -it -u 1000:1000 ollama_server_medium_01 bash -ic "ollama run deepseek-r1:8b --keepalive=24h"' > ./run.sh
#chmod u+x ./run.sh
#tmux new-window -t ollama_server_medium:9
#tmux send-keys -t ollama_server_medium:9 ./run.sh Enter
#sleep 10s

#echo 'docker exec -it -u 1000:1000 ollama_server_medium_01 bash -ic "ollama pull bge-m3:567m"' > ./run.sh
#chmod u+x ./run.sh
#tmux send-keys -t ollama_server_medium:1 ./run.sh Enter
#sleep 1s
#
#echo 'docker exec -it -u 1000:1000 ollama_server_medium_01 bash -ic "ollama pull bge-medium:335m"' > ./run.sh
#chmod u+x ./run.sh
#tmux send-keys -t ollama_server_medium:1 ./run.sh Enter
#sleep 1s
#
#echo 'docker exec -it -u 1000:1000 ollama_server_medium_01 bash -ic "ollama pull nomic-embed-text"' > ./run.sh
#chmod u+x ./run.sh
#tmux send-keys -t ollama_server_medium:1 ./run.sh Enter
#sleep 1s
#
#echo 'docker exec -it -u 1000:1000 ollama_server_medium_01 bash -ic "ollama pull snowflake-arctic-embed2:568m"' > ./run.sh
#chmod u+x ./run.sh
#tmux send-keys -t ollama_server_medium:1 ./run.sh Enter

rm ./run.sh
